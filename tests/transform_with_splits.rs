use lazy_static::lazy_static;
use serde_json::json;
use vellottie::parser::{
    breadcrumb::{Breadcrumb, ValueType},
    schema::helpers::transform::Transform,
    *,
};

#[test]
fn test_deserialize() {
    let mut breadcrumb = Breadcrumb::new();
    let root = (*JSON)
        .as_object()
        .ok_or(Error::UnexpectedChild {
            breadcrumb: breadcrumb.clone(),
            expected: ValueType::Layer,
        })
        .unwrap();
    let ks = Transform::from_obj(&mut breadcrumb, root);
    match ks {
        Ok(_) => {}
        Err(e) => panic!("{e}"),
    }
}

lazy_static! {
    static ref JSON: serde_json::Value = json!(
        {
            "o": {
                "a": 0,
                "k": 100,
                "ix": 11
            },
            "r": {
                "a": 1,
                "k": [
                    {
                        "t": 6,
                        "s": [
                            -111.042
                        ],
                        "h": 1
                    },
                    {
                        "i": {
                            "x": [
                                0.833
                            ],
                            "y": [
                                0.833
                            ]
                        },
                        "o": {
                            "x": [
                                0.167
                            ],
                            "y": [
                                0.167
                            ]
                        },
                        "t": 14,
                        "s": [
                            130.61
                        ]
                    },
                    {
                        "i": {
                            "x": [
                                0.452
                            ],
                            "y": [
                                0.756
                            ]
                        },
                        "o": {
                            "x": [
                                0.167
                            ],
                            "y": [
                                0.167
                            ]
                        },
                        "t": 22,
                        "s": [
                            130.61
                        ]
                    },
                    {
                        "i": {
                            "x": [
                                0.657
                            ],
                            "y": [
                                0.777
                            ]
                        },
                        "o": {
                            "x": [
                                0.283
                            ],
                            "y": [
                                0.475
                            ]
                        },
                        "t": 36,
                        "s": [
                            38.398
                        ]
                    },
                    {
                        "i": {
                            "x": [
                                0.637
                            ],
                            "y": [
                                0.598
                            ]
                        },
                        "o": {
                            "x": [
                                0.391
                            ],
                            "y": [
                                0.377
                            ]
                        },
                        "t": 58,
                        "s": [
                            0
                        ]
                    },
                    {
                        "i": {
                            "x": [
                                0.919
                            ],
                            "y": [
                                0.855
                            ]
                        },
                        "o": {
                            "x": [
                                0.712
                            ],
                            "y": [
                                0.338
                            ]
                        },
                        "t": 76,
                        "s": [
                            -21.163
                        ]
                    },
                    {
                        "i": {
                            "x": [
                                0.833
                            ],
                            "y": [
                                0.833
                            ]
                        },
                        "o": {
                            "x": [
                                0.232
                            ],
                            "y": [
                                0.258
                            ]
                        },
                        "t": 96,
                        "s": [
                            -76
                        ]
                    },
                    {
                        "i": {
                            "x": [
                                0.833
                            ],
                            "y": [
                                0.833
                            ]
                        },
                        "o": {
                            "x": [
                                0.167
                            ],
                            "y": [
                                0.167
                            ]
                        },
                        "t": 102,
                        "s": [
                            -102.337
                        ]
                    },
                    {
                        "i": {
                            "x": [
                                0.833
                            ],
                            "y": [
                                0.833
                            ]
                        },
                        "o": {
                            "x": [
                                0.167
                            ],
                            "y": [
                                0.167
                            ]
                        },
                        "t": 110,
                        "s": [
                            -119.332
                        ]
                    },
                    {
                        "i": {
                            "x": [
                                0.833
                            ],
                            "y": [
                                0.833
                            ]
                        },
                        "o": {
                            "x": [
                                0.167
                            ],
                            "y": [
                                0.167
                            ]
                        },
                        "t": 116,
                        "s": [
                            -98.042
                        ]
                    },
                    {
                        "t": 120,
                        "s": [
                            -111.042
                        ],
                        "h": 1
                    }
                ],
                "ix": 10
            },
            "p": {
                "s": true,
                "x": {
                    "a": 1,
                    "k": [
                        {
                            "t": 6,
                            "s": [
                                636
                            ],
                            "h": 1
                        },
                        {
                            "i": {
                                "x": [
                                    0.667
                                ],
                                "y": [
                                    1
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 14,
                            "s": [
                                490
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.333
                                ],
                                "y": [
                                    0
                                ]
                            },
                            "t": 22,
                            "s": [
                                428
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 36,
                            "s": [
                                515.2
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 58,
                            "s": [
                                512
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 76,
                            "s": [
                                512
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 96,
                            "s": [
                                508
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 102,
                            "s": [
                                556
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 110,
                            "s": [
                                573.999
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 116,
                            "s": [
                                496
                            ]
                        },
                        {
                            "t": 120,
                            "s": [
                                636
                            ],
                            "h": 1
                        }
                    ],
                    "ix": 3
                },
                "y": {
                    "a": 1,
                    "k": [
                        {
                            "t": 6,
                            "s": [
                                1619.746
                            ],
                            "h": 1
                        },
                        {
                            "i": {
                                "x": [
                                    0.667
                                ],
                                "y": [
                                    0.827
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 14,
                            "s": [
                                1236
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.493
                                ],
                                "y": [
                                    0.717
                                ]
                            },
                            "o": {
                                "x": [
                                    0.233
                                ],
                                "y": [
                                    0.368
                                ]
                            },
                            "t": 22,
                            "s": [
                                834
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.667
                                ],
                                "y": [
                                    1
                                ]
                            },
                            "o": {
                                "x": [
                                    0.324
                                ],
                                "y": [
                                    0.733
                                ]
                            },
                            "t": 36,
                            "s": [
                                602
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.662
                                ],
                                "y": [
                                    0.084
                                ]
                            },
                            "o": {
                                "x": [
                                    0.333
                                ],
                                "y": [
                                    0
                                ]
                            },
                            "t": 58,
                            "s": [
                                512
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.827
                                ],
                                "y": [
                                    0.692
                                ]
                            },
                            "o": {
                                "x": [
                                    0.516
                                ],
                                "y": [
                                    0.279
                                ]
                            },
                            "t": 76,
                            "s": [
                                526.678
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.725
                                ],
                                "y": [
                                    0.601
                                ]
                            },
                            "o": {
                                "x": [
                                    0.404
                                ],
                                "y": [
                                    0.263
                                ]
                            },
                            "t": 96,
                            "s": [
                                608.208
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.795
                                ],
                                "y": [
                                    0.612
                                ]
                            },
                            "o": {
                                "x": [
                                    0.283
                                ],
                                "y": [
                                    0.139
                                ]
                            },
                            "t": 102,
                            "s": [
                                675.038
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.325
                                ],
                                "y": [
                                    0.228
                                ]
                            },
                            "t": 110,
                            "s": [
                                939.005
                            ]
                        },
                        {
                            "i": {
                                "x": [
                                    0.833
                                ],
                                "y": [
                                    0.833
                                ]
                            },
                            "o": {
                                "x": [
                                    0.167
                                ],
                                "y": [
                                    0.167
                                ]
                            },
                            "t": 116,
                            "s": [
                                1472
                            ]
                        },
                        {
                            "t": 120,
                            "s": [
                                1619.746
                            ],
                            "h": 1
                        }
                    ],
                    "ix": 4
                }
            },
            "a": {
                "a": 0,
                "k": [
                    512,
                    512,
                    0
                ],
                "ix": 1,
                "l": 2
            },
            "s": {
                "a": 0,
                "k": [
                    100,
                    100,
                    100
                ],
                "ix": 6,
                "l": 2
            }
        }
    );
}
